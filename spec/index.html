
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Lightweight binary serialization format">
      
      
      
        <link rel="canonical" href="https://litevectors.org/spec/">
      
      
        <link rel="prev" href="../implementations/">
      
      
        <link rel="next" href="details/">
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.12">
    
    
      
        <title>Specification - LiteVectors</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    


  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#specification" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="LiteVectors" class="md-header__button md-logo" aria-label="LiteVectors" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LiteVectors
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Specification
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../implementations/" class="md-tabs__link">
      Implementations
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Spec
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LiteVectors" class="md-nav__button md-logo" aria-label="LiteVectors" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    LiteVectors
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../implementations/" class="md-nav__link">
        Implementations
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Spec
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Spec
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Specification
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Specification
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#element-layout" class="md-nav__link">
    Element Layout
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tag-format" class="md-nav__link">
    Tag Format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#primitive-types" class="md-nav__link">
    Primitive Types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#size-codes" class="md-nav__link">
    Size Codes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#field-ordering-within-structs" class="md-nav__link">
    Field Ordering within Structs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-list-semantics" class="md-nav__link">
    Default List Semantics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limits-and-validation" class="md-nav__link">
    Limits and Validation
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="details/" class="md-nav__link">
        Implementation Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tests/" class="md-nav__link">
        Test Vectors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="specification">Specification</h1>
<p>LiteVectors is a binary format </p>
<p>The data model is most similar to JSON, with primitive types like strings and numbers, along with a small handful of organizational structures:</p>
<ul>
<li>struct - name/value pairs (also known as a dictionary, object, map, or associative array in some environments)</li>
<li>list - an ordered sequence of values (a generic array)</li>
<li>vector - a length prefixed dense array of values (a strongly typed array)</li>
</ul>
<h2 id="element-layout">Element Layout</h2>
<p>LiteVector elements follow a traditional <em>tag, length, value</em> convention - all elements consist of a one byte tag and either a fixed length value, or length field and vector of values:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>┌─────┐
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>│ Tag │
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>└─────┘
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>┌─────┬────────┐
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>│ Tag │ Value  │
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>└─────┴────────┘
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>┌─────┬────────┬────────┐
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>│ Tag │ Length │ Vector │
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>└─────┴────────┴────────┘
</code></pre></div>
<h2 id="tag-format">Tag Format</h2>
<p>A tag byte is divided into two fields: a <code>type code</code> and a <code>size code</code>. The <code>type code</code> is stored in the high order 4 bits while the <code>size code</code> is stored in the lower 4 bits:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>     ┌────────┬────────┐
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>     │  Type  │  Size  │
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>     └────────┴────────┘
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>Bits: 7 6 5 4 | 3 2 1 0
</code></pre></div>
<p>The tag value <code>0xFF</code> is reserved as a NOP element, and should be ignored by a decoder. The NOP tag is used in advanced scenarios where an implementation needs precise control over vector alignment.</p>
<h2 id="primitive-types">Primitive Types</h2>
<p>There are 16 primitive types. Each type has a 'type size' - the size of a value of that type. </p>
<ul>
<li>All numeric values are <em>little endian</em></li>
<li>Signed integers are encoded in <em>two's complement</em></li>
<li><code>bool</code> is stored as a one byte value, 0 false, non-zero true</li>
<li><code>float32</code> is the IEEE 754 <em>binary32</em> encoding</li>
<li><code>float64</code> is the IEEE 754 <em>binary64</em> encoding</li>
<li><code>string</code> is UTF-8</li>
</ul>
<table>
<thead>
<tr>
<th align="right">Type Code</th>
<th align="left">Name</th>
<th align="left">Description</th>
<th align="center">Type Size</th>
<th align="right">Min</th>
<th align="right">Max</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">nil</td>
<td align="left">Null / No value</td>
<td align="center">0</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">struct</td>
<td align="left">Beginning of a <code>string</code>/value associative map</td>
<td align="center">0</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">list</td>
<td align="left">Beginning of a (heterogenous) sequence of elements</td>
<td align="center">0</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">end</td>
<td align="left">End tag for a <code>struct</code> or <code>list</code></td>
<td align="center">0</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">string</td>
<td align="left">UTF-8 encoded bytes</td>
<td align="center">1</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr>
<td align="right">5</td>
<td align="left">bool</td>
<td align="left">True / False</td>
<td align="center">1</td>
<td align="right">0 (false)</td>
<td align="right">255 (true)</td>
</tr>
<tr>
<td align="right">6</td>
<td align="left">u8</td>
<td align="left">Unsigned 8-bit integer</td>
<td align="center">1</td>
<td align="right">0</td>
<td align="right">255</td>
</tr>
<tr>
<td align="right">7</td>
<td align="left">u16</td>
<td align="left">Unsigned 16-bit integer</td>
<td align="center">2</td>
<td align="right">0</td>
<td align="right">65535</td>
</tr>
<tr>
<td align="right">8</td>
<td align="left">u32</td>
<td align="left">Unsigned 32-bit integer</td>
<td align="center">4</td>
<td align="right">0</td>
<td align="right">4294967295</td>
</tr>
<tr>
<td align="right">9</td>
<td align="left">u64</td>
<td align="left">Unsigned 64-bit integer</td>
<td align="center">8</td>
<td align="right">0</td>
<td align="right">18446744073709551615</td>
</tr>
<tr>
<td align="right">10</td>
<td align="left">i8</td>
<td align="left">Signed 8-bit integer</td>
<td align="center">1</td>
<td align="right">-128</td>
<td align="right">127</td>
</tr>
<tr>
<td align="right">11</td>
<td align="left">i16</td>
<td align="left">Signed 16-bit integer</td>
<td align="center">2</td>
<td align="right">-32768</td>
<td align="right">32767</td>
</tr>
<tr>
<td align="right">12</td>
<td align="left">i32</td>
<td align="left">Signed 32-bit integer</td>
<td align="center">4</td>
<td align="right">-2147483648</td>
<td align="right">2147483647</td>
</tr>
<tr>
<td align="right">13</td>
<td align="left">i64</td>
<td align="left">Signed 64-bit integer</td>
<td align="center">8</td>
<td align="right">-9223372036854775808</td>
<td align="right">9223372036854775807</td>
</tr>
<tr>
<td align="right">14</td>
<td align="left">f32</td>
<td align="left">IEEE-754 32-bit floating point number</td>
<td align="center">4</td>
<td align="right">-3.40282e+38</td>
<td align="right">3.40282e+38</td>
</tr>
<tr>
<td align="right">15</td>
<td align="left">f64</td>
<td align="left">IEEE-754 64-bit floating point number</td>
<td align="center">8</td>
<td align="right">-1.79769e+308</td>
<td align="right">1.79769e+308</td>
</tr>
</tbody>
</table>
<h2 id="size-codes">Size Codes</h2>
<p>There are 5 size codes, indicating the size of the length field following the tag byte. In the case of a single element, the 0 <code>size code</code> indicates that no length field follows the tag. Any tag with a <code>size code</code> that is not 0 is followed by an unsigned integer containing the length of the following vector. The length field is always in bytes (not number of elements).</p>
<table>
<thead>
<tr>
<th align="left">Size Code</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0</td>
<td align="left">single</td>
<td align="left">Single element, inline</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">size_1</td>
<td align="left">Vector with 1 byte (uint8) length field</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">size_2</td>
<td align="left">Vector with 2 byte (uint16) length field</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">size_4</td>
<td align="left">Vector with 4 byte (uint32) length field</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">size_8</td>
<td align="left">Vector with 8 byte (uint64) length field</td>
</tr>
<tr>
<td align="left">5-15</td>
<td align="left">unused</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h2 id="field-ordering-within-structs">Field Ordering within Structs</h2>
<p>LiteVectors requires fields in a <code>struct</code> to be written in a consistent order. The rational for this is that fields present earlier in a <code>struct</code> may affect deserialization of fields present later. Individual applications may selectively enforce or relax this requirement as they desire, but middleware services and libraries processing and forwarding LiteVector messages must take care to maintain the transmitted field order.</p>
<h2 id="default-list-semantics">Default List Semantics</h2>
<p>Within a given context such as a stream, socket, file, etc, LiteVector processing semantics are to behave as if in a <em>list</em>. Standalone elements are allowed, and multiple elements may be concatenated one after another.</p>
<p>By convention, a file containing raw LiteVector elements should have a <code>.ltv</code> extension.</p>
<h2 id="limits-and-validation">Limits and Validation</h2>
<p>The NOP tag <code>0xFF</code> should be discarded before any other processing. </p>
<p>A <code>size code</code> &gt; 4 is invalid and must be rejected.
A <code>string</code> must be valid UTF-8. The <code>string</code> datatype has a unit length of 1 byte, so a string with a <code>size code</code> of 0 must be an ASCII character &lt;= 0x7F.</p>
<p>The zero length elements <code>nil</code>, <code>struct</code>, <code>list</code>, and <code>end</code> must have a <code>size code</code> of 0.</p>
<p>All length fields are expressed in bytes. A vector length must be a multiple of its type length. Primitive type sizes greater than one are always a power of two, so this can be efficiently checked with a statement similar to:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">vectorLength</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">typeSize</span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">     </span><span class="cm">/* This is an error */</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="p">}</span>
</code></pre></div>
<p>All bit patterns for IEEE-754 <em>binary32</em> and <em>binary64</em> floating point numbers are valid. General purpose serializers should <em>not</em> scrub or alter floating point values, but pass them intact to application code to handle special cases.</p>
<p>All <code>struct</code> field names are strings.</p>
<p>Individual applications and libraries may set their own limits (or make them configurable) for the following:</p>
<ul>
<li>Vector size limits</li>
<li>Struct and list nesting depth</li>
<li>Number of consecutive <code>nop</code> bytes permitted</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate"], "search": "../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    

      <script src="../assets/javascripts/bundle.4b2c34cd.min.js"></script>
      
    

  </body>
</html>